{"version":3,"sources":["../../src/Controllers/usersController.js"],"names":["asyncHandler","require","getIdParam","db","User","Message","message","Op","Sequelize","exports","CreateUser","req","res","next","email","body","findUser","findOne","where","status","send","users","create","error","GetAllUsers","findAll","include","model","as","GetAUser","id","user","findByPk","UpdateUser","update","DeleteUser","u","isAdmin","destroy","DeleteAllUser","truncate"],"mappings":"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","sourcesContent":["const asyncHandler = require(\"../Middlewares/async\");\nconst { getIdParam } = require(\"../utils/validateId\");\nconst db = require(\"../DBCONFIG/models/index\");\nconst User = db.User;\nconst Message = db.message;\nconst Op = db.Sequelize.Op;\n\nexports.CreateUser = asyncHandler(async (req, res, next) => {\n  try {\n    const { email } = req.body;\n    const findUser = await User.findOne({ where: { email: email } });\n\n    if (findUser) return res.status(400).send(\"User already exists\");\n\n    const users = await User.create(req.body);\n\n    return res\n      .status(201)\n      .send({ message: \"User created successfully\", users });\n  } catch (error) {\n    return res.status(500).send(error.message);\n  }\n});\n\nexports.GetAllUsers = asyncHandler(async (req, res, next) => {\n  try {\n    const users = await User.findAll({\n      include: [{ model: Message, as: \"messages\" }],\n    });\n    if (!users) return res.status(404).send(\"No users exist\");\n\n    return res\n      .status(200)\n      .send({ message: \"Successfuly retrieved users\", users });\n  } catch (error) {\n    return res\n      .status(500)\n      .send(error.message || \"Some error occurred while retrieving users.\");\n  }\n});\n\nexports.GetAUser = asyncHandler(async (req, res, next) => {\n  const id = getIdParam(req);\n  try {\n    const user = await User.findByPk(id, {\n      include: [{ model: Message, as: \"messages\" }],\n    });\n    if (!user) return res.status(404).send(\"This user does not exist\");\n    return res\n      .status(200)\n      .send({ message: \"Successfuly retrieved users\", user });\n  } catch (error) {\n    return res\n      .status(500)\n      .send(error.message || \"Some error occurred while retrieving user.\");\n  }\n});\n\nexports.UpdateUser = asyncHandler(async (req, res, next) => {\n  const id = getIdParam(req);\n\n  try {\n    const user = await User.update(req.body, { where: { id: id } });\n\n    if (!user) return res.status(404).send(\"Error updating user\");\n\n    return res.status(200).send({ message: \"Successfuly updated user\" });\n  } catch (error) {\n    return res\n      .status(500)\n      .send(error.message || \"Some error occurred while updating user.\");\n  }\n});\n\nexports.DeleteUser = asyncHandler(async (req, res, next) => {\n  const id = getIdParam(req);\n\n  try {\n    const u = await User.findByPk(id);\n    if (u.isAdmin)\n      return res.status(404).send(\"Error! you cant delete an Admin\");\n\n    const user = await User.destroy({ where: { id: id } });\n\n    if (!user) return res.status(404).send(\"Error! User does not exist\");\n\n    return res.status(200).send({ message: \"Successfuly deleted user\" });\n  } catch (error) {\n    return res\n      .status(500)\n      .send(error.message || \"Some error occurred while deleting user.\");\n  }\n});\n\nexports.DeleteAllUser = asyncHandler(async (req, res, next) => {\n  try {\n    const user = await User.destroy({ where: {}, truncate: false });\n\n    if (!user) return res.status(404).send(\"Error deleting users.\");\n\n    return res.status(200).send({ message: \"Successfuly deleted all users.\" });\n  } catch (error) {\n    return res\n      .status(500)\n      .send(error.message || \"Some error occurred while deleting users.\");\n  }\n});\n"],"file":"usersController.js"}